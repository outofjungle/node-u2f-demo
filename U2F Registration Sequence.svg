<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1165" height="1020"><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1165" height="1020"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="447.4498834234688" y="24.50280495" text-anchor="start" dominant-baseline="alphabetic">U2F Registration Sequence</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 41.36730278469922 95.887643371 L 41.36730278469922 1020.4601501510007" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 163.78101959111197 95.887643371 L 163.78101959111197 1020.4601501510007" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.7859906964505 95.887643371 L 523.7859906964505 1020.4601501510007" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 810.7680263600573 95.887643371 L 810.7680263600573 1020.4601501510007" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1107.4923715939767 95.887643371 L 1107.4923715939767 1020.4601501510007" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601650000002 51.782594461 L 74.56700391939845 51.782594461 L 74.56700391939845 95.887643371 L 8.167601650000002 95.887643371 L 8.167601650000002 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.8912972305" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic">User</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 123.65218790221353 51.782594461 L 203.9098512800104 51.782594461 L 203.9098512800104 95.887643371 L 123.65218790221353 95.887643371 L 123.65218790221353 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="141.37588348271353" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic">Device</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 479.17971149778646 51.782594461 L 568.3922698951146 51.782594461 L 568.3922698951146 95.887643371 L 479.17971149778646 95.887643371 L 479.17971149778646 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="496.9034070782865" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 771.4552270808268 51.782594461 L 850.0808256392878 51.782594461 L 850.0808256392878 95.887643371 L 771.4552270808268 95.887643371 L 771.4552270808268 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="789.1789226613269" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic">Server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1057.9898826785159 51.782594461 L 1156.9948605094378 51.782594461 L 1156.9948605094378 95.887643371 L 1057.9898826785159 95.887643371 L 1057.9898826785159 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1075.7135782590158" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic">Datastore</text></g></g><g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="179.49292050582878" y="128.558049971" width="206.1674524694922" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="181.94320100082876" y="143.259732941" text-anchor="start" dominant-baseline="alphabetic">login with username, password</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 41.36730278469922 149.793814261 L 523.7859906964505 149.793814261" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 510.17332127978386 142.98747955266666 L 523.7859906964505 149.793814261 L 510.17332127978386 156.60014896933333 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="564.1932822935078" y="174.296619211" width="206.1674524694922" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="566.6435627885078" y="188.99830218099999" text-anchor="start" dominant-baseline="alphabetic">login with username, password</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.7859906964505 195.532383501 L 810.7680263600573 195.532383501" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 797.1553569433906 188.72604879266666 L 810.7680263600573 195.532383501 L 797.1553569433906 202.33871820933334 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="635.073699163625" y="220.035188451" width="64.40661872925781" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="637.523979658625" y="234.736871421" text-anchor="start" dominant-baseline="alphabetic">logged in</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 810.7680263600573 241.270952741 L 523.7859906964505 241.270952741" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 537.3986601131172 234.46461803266666 L 523.7859906964505 241.270952741 L 537.3986601131172 248.07728744933334 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="601.6771613828632" y="265.773757691" width="131.19969429078125" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="604.1274418778632" y="280.475440661" text-anchor="start" dominant-baseline="alphabetic">register new device</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.7859906964505 287.00952198100003 L 810.7680263600573 287.00952198100003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 797.1553569433906 280.2031872726667 L 810.7680263600573 287.00952198100003 L 797.1553569433906 293.8158566893334 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="633.4452125303242" y="311.512326931" width="67.66359199585938" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="635.8954930253242" y="326.214009901" text-anchor="start" dominant-baseline="alphabetic">challenge</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 810.7680263600573 332.74809122100004 L 523.7859906964505 332.74809122100004" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 537.3986601131172 325.9417565126667 L 523.7859906964505 332.74809122100004 L 537.3986601131172 339.5544259293334 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="268.40198838169135" y="357.250896171" width="150.7630335241797" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="270.85226887669137" y="371.952579141" text-anchor="start" dominant-baseline="alphabetic">register with challenge</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.7859906964505 378.48666046100004 L 163.78101959111197 378.48666046100004" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 177.39368900777865 371.6803257526667 L 163.78101959111197 378.48666046100004 L 177.39368900777865 385.2929951693334 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="183.11101016277865" y="402.989465411" width="35.05086006226563" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="185.56129065777864" y="417.691148381" text-anchor="start" dominant-baseline="alphabetic">blink</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 163.78101959111197 424.22522970100005 L 229.12183279111196 424.22522970100005 L 229.12183279111196 440.56043300100004 L 163.78101959111197 440.56043300100004" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 177.39368900777865 433.7540982926667 L 163.78101959111197 440.56043300100004 L 177.39368900777865 447.3667677093334 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="82.19260627884309" y="465.063237951" width="40.763109818125" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="84.64288677384309" y="479.764920921" text-anchor="start" dominant-baseline="alphabetic">touch</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 41.36730278469922 486.29900224100004 L 163.78101959111197 486.29900224100004" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 150.1683501744453 479.4926675326667 L 163.78101959111197 486.29900224100004 L 150.1683501744453 493.1053369493334 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="183.11101016277865" y="510.8018071910001" width="248.3005854040625" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="185.56129065777864" y="525.5034901610001" text-anchor="start" dominant-baseline="alphabetic">generate key pair privateKey, pubKey</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 163.78101959111197 532.0375714810001 L 229.12183279111196 532.0375714810001 L 229.12183279111196 548.3727747810001 L 163.78101959111197 548.3727747810001" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 177.39368900777865 541.5664400726668 L 163.78101959111197 548.3727747810001 L 177.39368900777865 555.1791094893334 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="183.11101016277865" y="572.875579731" width="334.95765937867185" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="185.56129065777864" y="587.577262701" text-anchor="start" dominant-baseline="alphabetic">sign challenge as signedChallenge with privateKey</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 163.78101959111197 594.111344021 L 229.12183279111196 594.111344021 L 229.12183279111196 610.446547321 L 163.78101959111197 610.446547321" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 177.39368900777865 603.6402126126667 L 163.78101959111197 610.446547321 L 177.39368900777865 617.2528820293334 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="183.11101016277865" y="634.9493522710002" width="202.91046394410156" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="185.56129065777864" y="649.6510352410002" text-anchor="start" dominant-baseline="alphabetic">wrap privateKey as keyHandle</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 163.78101959111197 656.1851165610002 L 229.12183279111196 656.1851165610002 L 229.12183279111196 672.5203198610002 L 163.78101959111197 672.5203198610002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 177.39368900777865 665.7139851526669 L 163.78101959111197 672.5203198610002 L 177.39368900777865 679.3266545693335 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="219.6224778836445" y="697.0231248110002" width="248.32205452027344" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="222.0727583786445" y="711.7248077810002" text-anchor="start" dominant-baseline="alphabetic">pubKey, keyHandle, signedChallenge</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 163.78101959111197 718.2588891010002 L 523.7859906964505 718.2588891010002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 510.17332127978386 711.4525543926669 L 523.7859906964505 718.2588891010002 L 510.17332127978386 725.0652238093336 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="543.1159812681171" y="742.7616940510003" width="248.32205452027344" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="545.5662617631172" y="757.4633770210003" text-anchor="start" dominant-baseline="alphabetic">pubKey, keyHandle, signedChallenge</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.7859906964505 763.9974583410003 L 810.7680263600573 763.9974583410003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 797.1553569433906 757.191123632667 L 810.7680263600573 763.9974583410003 L 797.1553569433906 770.8037930493336 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="830.098016931724" y="788.5002632910005" width="237.15526069703125" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="832.548297426724" y="803.2019462610004" text-anchor="start" dominant-baseline="alphabetic">verify signedChallenge with pubKey</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 810.7680263600573 809.7360275810005 L 876.1088395600573 809.7360275810005 L 876.1088395600573 826.0712308810005 L 810.7680263600573 826.0712308810005" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 824.380695776724 819.2648961726671 L 810.7680263600573 826.0712308810005 L 824.380695776724 832.8775655893338 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="830.098016931724" y="850.5740358310005" width="258.0643640905859" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="832.548297426724" y="865.2757188010005" text-anchor="start" dominant-baseline="alphabetic">store pubKey, keyHandle for username</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 810.7680263600573 871.8098001210005 L 1107.4923715939767 871.8098001210005" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1093.87970217731 865.0034654126672 L 1107.4923715939767 871.8098001210005 L 1093.87970217731 878.6161348293339 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="940.3735525152201" y="896.3126050710006" width="37.51329292359375" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="942.8238330102201" y="911.0142880410006" text-anchor="start" dominant-baseline="alphabetic">done</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1107.4923715939767 917.5483693610006 L 810.7680263600573 917.5483693610006" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 824.380695776724 910.7420346526673 L 810.7680263600573 917.5483693610006 L 824.380695776724 924.3547040693339 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="632.231902288625" y="942.0511743110006" width="70.09021247925781" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="634.682182783625" y="956.7528572810006" text-anchor="start" dominant-baseline="alphabetic">registered</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 810.7680263600573 963.2869386010007 L 523.7859906964505 963.2869386010007" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 537.3986601131172 956.4806038926673 L 523.7859906964505 963.2869386010007 L 537.3986601131172 970.093273309334 Z"/></g></g><g/><g/><g/><g/><g/></g></svg>