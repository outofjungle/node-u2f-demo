<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1088" height="1082"><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1088" height="1082"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="398.0902116179674" y="24.50280495" text-anchor="start" dominant-baseline="alphabetic">U2F Authentication Sequence</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 41.36730278469922 95.887643371 L 41.36730278469922 1082.5339226910007" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 163.78101959111197 95.887643371 L 163.78101959111197 1082.5339226910007" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.7859906964505 95.887643371 L 523.7859906964505 1082.5339226910007" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 768.6134243092761 95.887643371 L 768.6134243092761 1082.5339226910007" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1030.8159967329739 95.887643371 L 1030.8159967329739 1082.5339226910007" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601650000002 51.782594461 L 74.56700391939845 51.782594461 L 74.56700391939845 95.887643371 L 8.167601650000002 95.887643371 L 8.167601650000002 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.8912972305" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic">User</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 123.65218790221353 51.782594461 L 203.9098512800104 51.782594461 L 203.9098512800104 95.887643371 L 123.65218790221353 95.887643371 L 123.65218790221353 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="141.37588348271353" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic">Device</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 479.17971149778646 51.782594461 L 568.3922698951146 51.782594461 L 568.3922698951146 95.887643371 L 479.17971149778646 95.887643371 L 479.17971149778646 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="496.9034070782865" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 729.3006250300456 51.782594461 L 807.9262235885066 51.782594461 L 807.9262235885066 95.887643371 L 729.3006250300456 95.887643371 L 729.3006250300456 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="747.0243206105456" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic">Server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 981.3135078175129 51.782594461 L 1080.3184856484347 51.782594461 L 1080.3184856484347 95.887643371 L 981.3135078175129 95.887643371 L 981.3135078175129 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="999.0372033980129" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic">Datastore</text></g></g><g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="179.49292050582878" y="128.558049971" width="206.1674524694922" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="181.94320100082876" y="143.259732941" text-anchor="start" dominant-baseline="alphabetic">login with username, password</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 41.36730278469922 149.793814261 L 523.7859906964505 149.793814261" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 510.17332127978386 142.98747955266666 L 523.7859906964505 149.793814261 L 510.17332127978386 156.60014896933333 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="543.1159812681171" y="174.296619211" width="206.1674524694922" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="545.5662617631172" y="188.99830218099999" text-anchor="start" dominant-baseline="alphabetic">login with username, password</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.7859906964505 195.532383501 L 768.6134243092761 195.532383501" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 755.0007548926094 188.72604879266666 L 768.6134243092761 195.532383501 L 755.0007548926094 202.33871820933334 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="787.9434148809428" y="220.035188451" width="106.74014534058594" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="790.3936953759428" y="234.736871421" text-anchor="start" dominant-baseline="alphabetic">verify password</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 768.6134243092761 241.27095274100003 L 833.954237509276 241.27095274100003 L 833.954237509276 257.606156041 L 768.6134243092761 257.606156041" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 782.2260937259427 250.79982133266668 L 768.6134243092761 257.606156041 L 782.2260937259427 264.41249074933336 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="787.9434148809428" y="282.108960991" width="129.61059822144531" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="790.3936953759428" y="296.810643961" text-anchor="start" dominant-baseline="alphabetic">generate challenge</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 768.6134243092761 303.344725281 L 833.954237509276 303.344725281 L 833.954237509276 319.679928581 L 768.6134243092761 319.679928581" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 782.2260937259427 312.8735938726667 L 768.6134243092761 319.679928581 L 782.2260937259427 326.48626328933335 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="805.181437472414" y="344.182733531" width="189.06654609742188" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="807.631717967414" y="358.884416501" text-anchor="start" dominant-baseline="alphabetic">get keyHandle for username</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 768.6134243092761 365.418497821 L 1030.8159967329739 365.418497821" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1017.2033273163072 358.6121631126667 L 1030.8159967329739 365.418497821 L 1017.2033273163072 372.22483252933336 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="862.6295194426289" y="389.921302771" width="74.17038215699219" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="865.0797999376289" y="404.622985741" text-anchor="start" dominant-baseline="alphabetic">keyHandle</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1030.8159967329739 411.157067061 L 768.6134243092761 411.157067061" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 782.2260937259427 404.3507323526667 L 768.6134243092761 411.157067061 L 782.2260937259427 417.96340176933336 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="573.6599876157734" y="435.659872011" width="145.0794397741797" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="576.1102681107734" y="450.361554981" text-anchor="start" dominant-baseline="alphabetic">keyHandle, challenge</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 768.6134243092761 456.895636301 L 523.7859906964505 456.895636301" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 537.3986601131172 450.0893015926667 L 523.7859906964505 456.895636301 L 537.3986601131172 463.70197100933336 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="214.19656693393748" y="481.398441251" width="259.1738764196875" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="216.64684742893746" y="496.100124221" text-anchor="start" dominant-baseline="alphabetic">authenticate with keyHandle, challenge</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.7859906964505 502.63420554100003 L 163.78101959111197 502.63420554100003" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 177.39368900777865 495.8278708326667 L 163.78101959111197 502.63420554100003 L 177.39368900777865 509.44054024933337 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="183.11101016277865" y="527.137010491" width="35.05086006226563" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="185.56129065777864" y="541.8386934609999" text-anchor="start" dominant-baseline="alphabetic">blink</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 163.78101959111197 548.372774781 L 229.12183279111196 548.372774781 L 229.12183279111196 564.707978081 L 163.78101959111197 564.707978081" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 177.39368900777865 557.9016433726666 L 163.78101959111197 564.707978081 L 177.39368900777865 571.5143127893333 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="82.19260627884309" y="589.210783031" width="40.763109818125" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="84.64288677384309" y="603.912466001" text-anchor="start" dominant-baseline="alphabetic">touch</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 41.36730278469922 610.446547321 L 163.78101959111197 610.446547321" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 150.1683501744453 603.6402126126667 L 163.78101959111197 610.446547321 L 150.1683501744453 617.2528820293334 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="183.11101016277865" y="634.9493522710002" width="235.4873987585547" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="185.56129065777864" y="649.6510352410002" text-anchor="start" dominant-baseline="alphabetic">Unwrap privateKey from keyHandle</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 163.78101959111197 656.1851165610002 L 229.12183279111196 656.1851165610002 L 229.12183279111196 672.5203198610002 L 163.78101959111197 672.5203198610002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 177.39368900777865 665.7139851526669 L 163.78101959111197 672.5203198610002 L 177.39368900777865 679.3266545693335 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="183.11101016277865" y="697.0231248110003" width="334.95765937867185" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="185.56129065777864" y="711.7248077810003" text-anchor="start" dominant-baseline="alphabetic">sign challenge as signedChallenge with privateKey</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 163.78101959111197 718.2588891010004 L 229.12183279111196 718.2588891010004 L 229.12183279111196 734.5940924010004 L 163.78101959111197 734.5940924010004" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 177.39368900777865 727.787757692667 L 163.78101959111197 734.5940924010004 L 177.39368900777865 741.4004271093337 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="286.72337662632026" y="759.0968973510004" width="114.12025703492188" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="289.1736571213203" y="773.7985803210004" text-anchor="start" dominant-baseline="alphabetic">signedChallenge</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 163.78101959111197 780.3326616410004 L 523.7859906964505 780.3326616410004" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 510.17332127978386 773.5263269326671 L 523.7859906964505 780.3326616410004 L 510.17332127978386 787.1389963493338 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="589.1395789854023" y="804.8354665910005" width="114.12025703492188" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="591.5898594804023" y="819.5371495610004" text-anchor="start" dominant-baseline="alphabetic">signedChallenge</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 523.7859906964505 826.0712308810005 L 768.6134243092761 826.0712308810005" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 755.0007548926094 819.2648961726671 L 768.6134243092761 826.0712308810005 L 755.0007548926094 832.8775655893338 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="814.9559430876484" y="850.5740358310005" width="169.51753486695313" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.4062235826484" y="865.2757188010005" text-anchor="start" dominant-baseline="alphabetic">get pubKey for username</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 768.6134243092761 871.8098001210005 L 1030.8159967329739 871.8098001210005" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1017.2033273163072 865.0034654126672 L 1030.8159967329739 871.8098001210005 L 1017.2033273163072 878.6161348293339 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="872.4040250578632" y="896.3126050710006" width="54.62137092652344" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="874.8543055528633" y="911.0142880410006" text-anchor="start" dominant-baseline="alphabetic">pubKey</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1030.8159967329739 917.5483693610006 L 768.6134243092761 917.5483693610006" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 782.2260937259427 910.7420346526673 L 768.6134243092761 917.5483693610006 L 782.2260937259427 924.3547040693339 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="787.9434148809428" y="942.0511743110008" width="237.15526069703125" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="790.3936953759428" y="956.7528572810007" text-anchor="start" dominant-baseline="alphabetic">verify signedChallenge with pubKey</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 768.6134243092761 963.2869386010008 L 833.954237509276 963.2869386010008 L 833.954237509276 979.6221419010008 L 768.6134243092761 979.6221419010008" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 782.2260937259427 972.8158071926674 L 768.6134243092761 979.6221419010008 L 782.2260937259427 986.4284766093341 Z"/></g><g><g><path fill="none" stroke="none"/><rect fill="white" stroke="none" x="599.7336951963398" y="1004.1249468510008" width="92.93202461304688" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.1839756913398" y="1018.8266298210008" text-anchor="start" dominant-baseline="alphabetic">authenticated</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 768.6134243092761 1025.3607111410008 L 523.7859906964505 1025.3607111410008" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 537.3986601131172 1018.5543764326675 L 523.7859906964505 1025.3607111410008 L 537.3986601131172 1032.167045849334 Z"/></g></g><g/><g/><g/><g/><g/></g></svg>